!function(h){TPHB_Extra_Site={init:function(){this.toggle_extra(),this.removePackage()},parseJSON:function(a){if(!h.isPlainObject(a)){var t=a.match(/<!-- HB_AJAX_START -->(.*)<!-- HB_AJAX_END -->/);try{a=t?h.parseJSON(t[1]):h.parseJSON(a)}catch(t){console.log(t),a={}}}return a},toggle_extra:function(){h(document).on("change",".number_room_select",function(t){t.preventDefault();var a=h(this),e=a.parents(".hb-search-room-results"),i=e.find(".hb_addition_package_extra"),n=i.find(".hb_addition_packages"),o=a.val();""!==o?(e.parent().siblings().find(".hb_addition_packages").removeClass("active").slideUp(),n.removeAttr("style").addClass("active"),i.removeAttr("style").slideDown()):(i.slideUp(),o=1),e.find(".hb_optional_quantity").val(o)}),h(document).on("click",".hb_package_toggle",function(t){t.preventDefault();var a=h(this),e=a.parents(".hb_addition_package_extra");toggle=e.find(".hb_addition_packages"),a.toggleClass("active"),toggle.toggleClass("active"),TPHB_Extra_Site.optional_toggle(toggle)})},optional_toggle:function(t){t.hasClass("active")?t.slideDown():t.slideUp()},toggleCheckbox:function(){h(document).on("change",".hb_optional_quantity_selected",function(t){t.preventDefault();var a=h(this),e=a.parents("li:first").find(".hb_optional_quantity");a.is(":checked")?e.attr("readonly",!0):e.hasClass("tp_hb_readonly")||e.removeAttr("readonly")})},removePackage:function(){h(document).on("click",".hb_package_remove",function(t){t.preventDefault();var a=h(this),e=a.attr("data-cart-id"),i=a.parents(".hb_mini_cart_item:first"),n=a.parents(".hb_mini_cart_item:first, tr");void 0!==i&&0!==i.length||(i=a.parents(".hb_checkout_item.package:first")),h.ajax({url:hotel_settings.ajax,method:"POST",data:{action:"tp_hotel_booking_remove_package",cart_id:e},dataType:"html",beforeSend:function(){n.hb_overlay_ajax_start()}}).done(function(l){void 0!==(l=TPHB_Extra_Site.parseJSON(l)).status&&"success"===l.status&&(HB_Booking_Cart.hb_add_to_cart_callback(l,function(){for(var t=h("#hotel-booking-payment, #hotel-booking-cart"),a=0;a<t.length;a++){for(var e=h(t[a]),i=e.find("table").find(".hb_checkout_item.package"),n=0;n<i.length;n++){var o=h(i[n]),r=o.attr("data-cart-id"),_=o.attr("data-parent-id");if(r===l.package_id&&_===l.cart_id){h('tr.hb_checkout_item.package[data-cart-id="'+r+'"][data-parent-id="'+_+'"]');var c=h('tr.hb_addition_services_title[data-cart-id="'+_+'"]'),d=h('.hb_checkout_item:not(.package)[data-cart-id="'+_+'"]');if(1===h('tr.hb_checkout_item.package[data-parent-id="'+_+'"]').length)o.remove(),c.remove(),d.find("td:first").removeAttr("rowspan");else{var s=d.find("td:first").attr("rowspan");o.remove(),d.find("td:first").attr("rowspan",s-1)}break}}void 0!==l.sub_total&&e.find("span.hb_sub_total_value").html(l.sub_total),void 0!==l.grand_total&&e.find("span.hb_grand_total_value").html(l.grand_total),void 0!==l.advance_payment&&e.find("span.hb_advance_payment_value").html(l.advance_payment)}}),h("body").trigger("hb_remove_extra_to_cart")),n.hb_overlay_ajax_stop()})})}},h(document).ready(function(){TPHB_Extra_Site.init()})}(jQuery);